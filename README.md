# React-Grid-Layout

[![npm package](https://img.shields.io/npm/v/react-grid-layout.svg?style=flat-square)](https://www.npmjs.org/package/react-grid-layout)
[![npm downloads](https://img.shields.io/npm/dt/react-grid-layout.svg?maxAge=2592000)]()

React-Grid-Layout is a grid layout system much like [Packery](http://packery.metafizzy.co/) or
[Gridster](http://dsmorse.github.io/gridster.js/), for React.

Unlike those systems, it is responsive and supports breakpoints. Breakpoint layouts can be provided by the user
or autogenerated.

RGL is React-only and does not require jQuery.

![BitMEX UI](http://i.imgur.com/oo1NT6c.gif)

> GIF from production usage on [BitMEX.com](https://www.bitmex.com)

[**[Demo](https://react-grid-layout.github.io/react-grid-layout/) | [Changelog](/CHANGELOG.md) | [CodeSandbox Editable demo](https://codesandbox.io/s/5wy3rz5z1x?module=%2Fsrc%2FShowcaseLayout.js)**]

## Table of Contents

- [What's New in v2](#whats-new-in-v2)
- [Demos](#demos)
- [Features](#features)
- [Installation](#installation)
- [Quick Start](#quick-start)
- [Responsive Usage](#responsive-usage)
- [Providing Grid Width](#providing-grid-width)
- [API Reference](#api-reference)
- [Migrating from v1](#migrating-from-v1)
- [Performance](#performance)
- [Contribute](#contribute)

## What's New in v2

Version 2 is a complete TypeScript rewrite with a modernized API:

- **Full TypeScript support** - First-class types, no more `@types/react-grid-layout`
- **React Hooks** - New `useContainerWidth`, `useGridLayout`, and `useResponsiveLayout` hooks
- **Modular architecture** - Import only what you need:
  - `react-grid-layout` - React components and hooks
  - `react-grid-layout/core` - Pure layout algorithms (framework-agnostic)
  - `react-grid-layout/legacy` - v1 API compatibility
- **Smaller bundle** - Tree-shakeable ESM and CJS builds
- **Cleaner API** - Simplified component names (`GridLayout` instead of `ReactGridLayout`)

### Breaking Changes

- `width` prop is now required (use `useContainerWidth` hook or provide your own)
- Removed UMD/script tag bundle - use a bundler like Vite, webpack, or esbuild
- `verticalCompact` prop removed - use `compactType={null}` instead

## Demos

1. [Showcase](https://react-grid-layout.github.io/react-grid-layout/examples/00-showcase.html)
1. [Basic](https://react-grid-layout.github.io/react-grid-layout/examples/01-basic.html)
1. [No Dragging/Resizing (Layout Only)](https://react-grid-layout.github.io/react-grid-layout/examples/02-no-dragging.html)
1. [Messy Layout Autocorrect](https://react-grid-layout.github.io/react-grid-layout/examples/03-messy.html)
1. [Layout Defined on Children](https://react-grid-layout.github.io/react-grid-layout/examples/04-grid-property.html)
1. [Static Elements](https://react-grid-layout.github.io/react-grid-layout/examples/05-static-elements.html)
1. [Adding/Removing Elements](https://react-grid-layout.github.io/react-grid-layout/examples/06-dynamic-add-remove.html)
1. [Saving Layout to LocalStorage](https://react-grid-layout.github.io/react-grid-layout/examples/07-localstorage.html)
1. [Saving a Responsive Layout to LocalStorage](https://react-grid-layout.github.io/react-grid-layout/examples/08-localstorage-responsive.html)
1. [Minimum and Maximum Width/Height](https://react-grid-layout.github.io/react-grid-layout/examples/09-min-max-wh.html)
1. [Dynamic Minimum and Maximum Width/Height](https://react-grid-layout.github.io/react-grid-layout/examples/10-dynamic-min-max-wh.html)
1. [No Vertical Compacting (Free Movement)](https://react-grid-layout.github.io/react-grid-layout/examples/11-no-vertical-compact.html)
1. [Prevent Collision](https://react-grid-layout.github.io/react-grid-layout/examples/12-prevent-collision.html)
1. [Error Case](https://react-grid-layout.github.io/react-grid-layout/examples/13-error-case.html)
1. [Toolbox](https://react-grid-layout.github.io/react-grid-layout/examples/14-toolbox.html)
1. [Drag From Outside](https://react-grid-layout.github.io/react-grid-layout/examples/15-drag-from-outside.html)
1. [Bounded Layout](https://react-grid-layout.github.io/react-grid-layout/examples/16-bounded.html)
1. [Responsive Bootstrap-style Layout](https://react-grid-layout.github.io/react-grid-layout/examples/17-responsive-bootstrap-style.html)
1. [Scaled Containers](https://react-grid-layout.github.io/react-grid-layout/examples/18-scale.html)
1. [Allow Overlap](https://react-grid-layout.github.io/react-grid-layout/examples/19-allow-overlap.html)
1. [All Resizable Handles](https://react-grid-layout.github.io/react-grid-layout/examples/20-resizable-handles.html)
1. [Single Row Horizontal](https://react-grid-layout.github.io/react-grid-layout/examples/21-horizontal.html)

#### Projects Using React-Grid-Layout

- [Basedash](https://www.basedash.com)
- [BitMEX](https://www.bitmex.com/)
- [AWS CloudFront Dashboards](https://aws.amazon.com/blogs/aws/cloudwatch-dashboards-create-use-customized-metrics-views/)
- [Grafana](https://grafana.com/)
- [Metabase](http://www.metabase.com/)
- [HubSpot](http://www.hubspot.com)
- [Kibana](https://www.elastic.co/products/kibana)
- [Monday](https://support.monday.com/hc/en-us/articles/360002187819-What-are-the-Dashboards-)

_Know of others? Create a PR to let me know!_

## Features

- 100% React - no jQuery
- Full TypeScript support
- Compatible with server-rendered apps
- Draggable widgets
- Resizable widgets
- Static widgets
- Configurable packing: horizontal, vertical, or off
- Bounds checking for dragging and resizing
- Widgets may be added or removed without rebuilding grid
- Layout can be serialized and restored
- Responsive breakpoints
- Separate layouts per responsive breakpoint
- Grid Items placed using CSS Transforms
- Compatibility with `<React.StrictMode>`

| Version   | Compatibility         |
| --------- | --------------------- |
| >= 2.0.0  | React 18+, TypeScript |
| >= 0.17.0 | React 16 & 17         |

## Installation

```bash
npm install react-grid-layout
```

Include the stylesheets in your application:

```js
import "react-grid-layout/css/styles.css";
import "react-resizable/css/styles.css";
```

Or link them directly:

```html
<link rel="stylesheet" href="/node_modules/react-grid-layout/css/styles.css" />
<link rel="stylesheet" href="/node_modules/react-resizable/css/styles.css" />
```

## Quick Start

```tsx
import { GridLayout, useContainerWidth } from "react-grid-layout";
import "react-grid-layout/css/styles.css";
import "react-resizable/css/styles.css";

function MyGrid() {
  const { width, containerRef, mounted } = useContainerWidth();

  const layout = [
    { i: "a", x: 0, y: 0, w: 1, h: 2, static: true },
    { i: "b", x: 1, y: 0, w: 3, h: 2, minW: 2, maxW: 4 },
    { i: "c", x: 4, y: 0, w: 1, h: 2 }
  ];

  return (
    <div ref={containerRef}>
      {mounted && (
        <GridLayout layout={layout} cols={12} rowHeight={30} width={width}>
          <div key="a">a</div>
          <div key="b">b</div>
          <div key="c">c</div>
        </GridLayout>
      )}
    </div>
  );
}
```

You can also define layout on children using `data-grid`:

```tsx
<GridLayout cols={12} rowHeight={30} width={width}>
  <div key="a" data-grid={{ x: 0, y: 0, w: 1, h: 2, static: true }}>
    a
  </div>
  <div key="b" data-grid={{ x: 1, y: 0, w: 3, h: 2 }}>
    b
  </div>
  <div key="c" data-grid={{ x: 4, y: 0, w: 1, h: 2 }}>
    c
  </div>
</GridLayout>
```

## Responsive Usage

Use `ResponsiveGridLayout` for automatic breakpoint handling:

```tsx
import { ResponsiveGridLayout, useContainerWidth } from "react-grid-layout";

function MyResponsiveGrid() {
  const { width, containerRef, mounted } = useContainerWidth();

  const layouts = {
    lg: [{ i: "1", x: 0, y: 0, w: 2, h: 2 }],
    md: [{ i: "1", x: 0, y: 0, w: 2, h: 2 }]
  };

  return (
    <div ref={containerRef}>
      {mounted && (
        <ResponsiveGridLayout
          layouts={layouts}
          breakpoints={{ lg: 1200, md: 996, sm: 768, xs: 480, xxs: 0 }}
          cols={{ lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 }}
          width={width}
        >
          <div key="1">1</div>
          <div key="2">2</div>
          <div key="3">3</div>
        </ResponsiveGridLayout>
      )}
    </div>
  );
}
```

## Providing Grid Width

The `width` prop is required. You have several options:

### Option 1: useContainerWidth Hook (Recommended)

```tsx
import { GridLayout, useContainerWidth } from "react-grid-layout";

function MyGrid() {
  const { width, containerRef, mounted } = useContainerWidth();

  return (
    <div ref={containerRef}>
      {mounted && <GridLayout width={width}>...</GridLayout>}
    </div>
  );
}
```

### Option 2: Fixed Width

```tsx
<GridLayout width={1200}>...</GridLayout>
```

### Option 3: CSS Container Queries or ResizeObserver

Use any width measurement library like [react-sizeme](https://github.com/ctrlplusb/react-sizeme) or your own ResizeObserver implementation.

### Option 4: Legacy WidthProvider HOC

For backwards compatibility, you can still use `WidthProvider`:

```tsx
import ReactGridLayout, { WidthProvider } from "react-grid-layout/legacy";

const GridLayoutWithWidth = WidthProvider(ReactGridLayout);

function MyGrid() {
  return <GridLayoutWithWidth>...</GridLayoutWithWidth>;
}
```

## API Reference

### GridLayout Props

```ts
interface GridLayoutProps {
  // Required
  children: React.ReactNode;
  width: number; // Container width in pixels

  // Grid configuration
  cols?: number; // Number of columns (default: 12)
  rowHeight?: number; // Height of each row in pixels (default: 150)
  maxRows?: number; // Maximum number of rows (default: Infinity)
  margin?: [number, number]; // Margin between items [x, y] (default: [10, 10])
  containerPadding?: [number, number] | null; // Padding inside container (default: margin)
  layout?: Layout; // Layout definition

  // Behavior
  compactType?: "vertical" | "horizontal" | null; // Compaction direction (default: 'vertical')
  autoSize?: boolean; // Auto-size container height (default: true)
  isDraggable?: boolean; // Enable dragging (default: true)
  isResizable?: boolean; // Enable resizing (default: true)
  isBounded?: boolean; // Keep items within container (default: false)
  isDroppable?: boolean; // Allow external drops (default: false)
  preventCollision?: boolean; // Prevent items from colliding (default: false)
  allowOverlap?: boolean; // Allow items to overlap (default: false)

  // Transforms
  useCSSTransforms?: boolean; // Use CSS transforms (default: true)
  transformScale?: number; // Scale factor for transforms (default: 1)

  // Drag handles
  draggableHandle?: string; // CSS selector for drag handle
  draggableCancel?: string; // CSS selector to cancel dragging

  // Resize handles
  resizeHandles?: Array<"s" | "w" | "e" | "n" | "sw" | "nw" | "se" | "ne">;
  resizeHandle?: ResizeHandle; // Custom resize handle component

  // Dropping
  droppingItem?: LayoutItem; // Item configuration when dropping from outside

  // Callbacks
  onLayoutChange?: (layout: Layout) => void;
  onDragStart?: EventCallback;
  onDrag?: EventCallback;
  onDragStop?: EventCallback;
  onResizeStart?: EventCallback;
  onResize?: EventCallback;
  onResizeStop?: EventCallback;
  onDrop?: (layout: Layout, item: LayoutItem | undefined, e: Event) => void;
  onDropDragOver?: (e: DragEvent) => { w?: number; h?: number } | false | void;

  // Styling
  className?: string;
  style?: React.CSSProperties;
  innerRef?: React.Ref<HTMLDivElement>;
}
```

### ResponsiveGridLayout Props

Extends `GridLayoutProps` with responsive-specific props:

```ts
interface ResponsiveGridLayoutProps<B extends string = string> {
  // Responsive configuration
  breakpoint?: B; // Current breakpoint (auto-detected)
  breakpoints?: Record<B, number>; // Breakpoint definitions (default: {lg: 1200, md: 996, sm: 768, xs: 480, xxs: 0})
  cols?: Record<B, number>; // Columns per breakpoint (default: {lg: 12, md: 10, sm: 6, xs: 4, xxs: 2})
  layouts?: Record<B, Layout>; // Layouts per breakpoint

  // Can be fixed or per-breakpoint
  margin?: [number, number] | Partial<Record<B, [number, number]>>;
  containerPadding?:
    | [number, number]
    | Partial<Record<B, [number, number] | null>>
    | null;

  // Callbacks
  onBreakpointChange?: (newBreakpoint: B, cols: number) => void;
  onLayoutChange?: (layout: Layout, layouts: Record<B, Layout>) => void;
  onWidthChange?: (
    width: number,
    margin: [number, number],
    cols: number,
    padding: [number, number] | null
  ) => void;
}
```

### Layout Item

```ts
interface LayoutItem {
  i: string; // Unique identifier (must match child key)
  x: number; // X position in grid units
  y: number; // Y position in grid units
  w: number; // Width in grid units
  h: number; // Height in grid units
  minW?: number; // Minimum width (default: 0)
  maxW?: number; // Maximum width (default: Infinity)
  minH?: number; // Minimum height (default: 0)
  maxH?: number; // Maximum height (default: Infinity)
  static?: boolean; // If true, not draggable or resizable
  isDraggable?: boolean; // Override grid isDraggable
  isResizable?: boolean; // Override grid isResizable
  isBounded?: boolean; // Override grid isBounded
  resizeHandles?: Array<"s" | "w" | "e" | "n" | "sw" | "nw" | "se" | "ne">;
}
```

### Hooks

#### useContainerWidth

Observes container width changes using ResizeObserver:

```ts
interface UseContainerWidthOptions {
  measureBeforeMount?: boolean; // Delay render until measured (default: false)
  initialWidth?: number; // Initial width before measurement (default: 1280)
}

interface UseContainerWidthResult {
  width: number; // Current container width
  mounted: boolean; // Whether container has been measured
  containerRef: RefObject<HTMLDivElement>; // Ref to attach to container
  measureWidth: () => void; // Manually trigger measurement
}

function useContainerWidth(
  options?: UseContainerWidthOptions
): UseContainerWidthResult;
```

#### useGridLayout

Core layout state management (advanced):

```ts
function useGridLayout(options: UseGridLayoutOptions): UseGridLayoutResult;
```

#### useResponsiveLayout

Responsive breakpoint management (advanced):

```ts
function useResponsiveLayout(
  options: UseResponsiveLayoutOptions
): UseResponsiveLayoutResult;
```

### Core Utilities

Import pure layout functions from `react-grid-layout/core`:

```ts
import {
  compact,
  moveElement,
  collides,
  getFirstCollision,
  validateLayout
  // ... and more
} from "react-grid-layout/core";
```

## Migrating from v1

### Minimal Changes (Use Legacy API)

The easiest migration path is to use the legacy compatibility layer:

```diff
- import GridLayout, { Responsive, WidthProvider } from 'react-grid-layout';
+ import GridLayout, { Responsive, WidthProvider } from 'react-grid-layout/legacy';
```

This provides 100% API compatibility with v1.

### Full Migration to v2

1. **Update imports:**

```diff
- import GridLayout from 'react-grid-layout';
+ import { GridLayout, useContainerWidth } from 'react-grid-layout';
```

2. **Add width handling:**

```diff
function MyGrid() {
+  const { width, containerRef, mounted } = useContainerWidth();
+
   return (
-    <GridLayout width={1200}>
+    <div ref={containerRef}>
+      {mounted && (
+        <GridLayout width={width}>
           ...
-    </GridLayout>
+        </GridLayout>
+      )}
+    </div>
   );
}
```

3. **Update deprecated props:**

```diff
<GridLayout
-  verticalCompact={false}
+  compactType={null}
>
```

4. **Update component names (optional):**

```diff
- import { Responsive as ResponsiveGridLayout } from 'react-grid-layout/legacy';
+ import { ResponsiveGridLayout } from 'react-grid-layout';
```

## Performance

### Memoize Children

The grid compares children by reference. Memoize them for better performance:

```tsx
function MyGrid({ count }) {
  const children = useMemo(() => {
    return Array.from({ length: count }, (_, i) => (
      <div
        key={i}
        data-grid={{ x: i % 12, y: Math.floor(i / 12), w: 1, h: 1 }}
      />
    ));
  }, [count]);

  return (
    <GridLayout cols={12} width={width}>
      {children}
    </GridLayout>
  );
}
```

### Avoid Creating Components in Render

Don't create the width-provided component during render:

```tsx
// Bad - creates new component every render
function MyGrid() {
  const GridLayoutWithWidth = WidthProvider(GridLayout);
  return <GridLayoutWithWidth>...</GridLayoutWithWidth>;
}

// Good - create once outside or with useMemo
const GridLayoutWithWidth = WidthProvider(GridLayout);

function MyGrid() {
  return <GridLayoutWithWidth>...</GridLayoutWithWidth>;
}
```

## Custom Child Components

Grid children must forward refs and certain props:

```tsx
const CustomItem = forwardRef<HTMLDivElement, CustomItemProps>(
  (
    {
      style,
      className,
      onMouseDown,
      onMouseUp,
      onTouchEnd,
      children,
      ...props
    },
    ref
  ) => {
    return (
      <div
        ref={ref}
        style={style}
        className={className}
        onMouseDown={onMouseDown}
        onMouseUp={onMouseUp}
        onTouchEnd={onTouchEnd}
      >
        {children}
      </div>
    );
  }
);
```

## Contribute

If you have a feature request, please add it as an issue or make a pull request.

If you have a bug to report, please reproduce the bug in [CodeSandbox](https://codesandbox.io/s/staging-bush-3lvt7?file=/src/ShowcaseLayout.js) to help
us easily isolate it.
